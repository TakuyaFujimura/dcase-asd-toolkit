# @package _global_
defaults:
    - override /datamodule: basic
    - override /frontend: dis_beats
    - override /trainer: default


label_dict_path:
  main_label: "labels/${dcase}/machine_section_attr_domain.json"

model_ver: "all"

trainer:
  max_epochs: 25
  # accumulate_grad_batches: 8

datamodule:
  batch_size: 8

frontend:
  model_cfg:
    extractor_cfg:
      model_cfg:
        ckpt_path: "pretrained_models/beats/BEATs_iter3.pt"
    loss_cfg:
      tgt_class: asdit.losses.SCAdaCos
      n_subclusters: 16
      dynamic: false
      trainable: true
    augmentation_cfg_list:
      - tgt_class: asdit.augmentations.Mixup
        prob: 0.5
  optim_cfg:
    tgt_class: torch.optim.AdamW
    lr: 1.0e-4
  scheduler_cfg:
    tgt_class: timm.scheduler.CosineLRScheduler
    t_initial: 5001
    lr_min: ${frontend.optim_cfg.lr}
    warmup_t: 5000
    warmup_lr_init: 0
  partially_saved_param_list: ["lora"]
